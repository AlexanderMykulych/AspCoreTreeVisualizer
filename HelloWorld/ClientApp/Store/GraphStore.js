import Vue from "vue";
import { getStoreAccessors } from "vuex-typescript";
import _ from "lodash";
import { uniqId } from "../mixins/IdGenerator";
export var graphModule = {
    namespaced: true,
    state: {
        Graphs: [],
        Characteristics: [
            {
                Name: "Char 1",
                Values: [{
                        Id: uniqId(),
                        Name: "Char 1. Value 1"
                    }, {
                        Id: uniqId(),
                        Name: "Char 1. Value 2"
                    }]
            },
            {
                Name: "Char 2",
                Values: [{
                        Id: uniqId(),
                        Name: "Char 2. Value 1"
                    }, {
                        Id: uniqId(),
                        Name: "Char 2. Value 2"
                    }, {
                        Id: uniqId(),
                        Name: "Char 2. Value 3"
                    }
                ]
            },
            {
                Name: "Char 3",
                Values: [{
                        Id: uniqId(),
                        Name: "Char 3. Value 1"
                    }, {
                        Id: uniqId(),
                        Name: "Char 3. Value 2"
                    }, {
                        Id: uniqId(),
                        Name: "Char 3. Value 3"
                    }, {
                        Id: uniqId(),
                        Name: "Char 3. Value 4"
                    }, {
                        Id: uniqId(),
                        Name: "Char 3. Value 5"
                    }, {
                        Id: uniqId(),
                        Name: "Char 3. Value 6"
                    }, {
                        Id: uniqId(),
                        Name: "Char 3. Value 7"
                    }, {
                        Id: uniqId(),
                        Name: "Char 3. Value 8"
                    }, {
                        Id: uniqId(),
                        Name: "Char 3. Value 9"
                    }
                ]
            }
        ],
        Roles: [
            {
                Id: uniqId(),
                Name: "Role 1"
            },
            {
                Id: uniqId(),
                Name: "Role 2"
            },
            {
                Id: uniqId(),
                Name: "Role 3"
            }
        ]
    },
    getters: {
        getGraph: function (state) {
            return state.Graphs;
        },
        graphCount: function (state) {
            return state.Graphs.length;
        },
        getSyncfusionGraphByName: function (state) {
            return function (name) {
                var graph = _.first(state.Graphs.filter(function (x) { return x.Name === name; }));
                return graphModule.getters.getSyncfusiongGraphByGraph(state)(graph);
            };
        },
        getSyncfusiongGraphByGraph: function (state) {
            return function (graph) {
                return {
                    Name: graph.Name,
                    Nodes: graph.Points,
                    Connectors: _.map(graph.Dependencies, function (con) {
                        return _.merge({
                            name: con.Name,
                            sourceNode: con.Start ? con.Start.name : null,
                            targetNode: con.End ? con.End.name : null
                        }, con);
                    })
                };
            };
        },
        getCharacteristicsList: function (state) {
            return state.Characteristics;
        },
        getRoles: function (state) {
            return state.Roles;
        }
    },
    mutations: {
        addGraph: function (state, item) {
            state.Graphs.push(item);
        },
        addPoint: function (state, item) {
            var graph = _.find(state.Graphs, function (x) { return x.Name === item.graph; });
            var duplicatePointIndex = _.findIndex(graph.Points, function (x) { return x.name === item.point.name; });
            if (duplicatePointIndex < 0) {
                graph.Points.push(item.point);
            }
            else {
                var duplicatePoint = graph.Points[duplicatePointIndex];
                _.assign(duplicatePoint, item.point);
                graph.Points.splice(duplicatePointIndex, 1, duplicatePoint);
            }
        },
        addDependency: function (state, item) {
            //TODO: Применить измение к диаграме
            var graph = _.find(state.Graphs, function (x) { return x.Name === item.graph; });
            var duplicateDepIndex = _.findIndex(graph.Dependencies, function (x) { return x.Name === item.dep.Name; });
            if (duplicateDepIndex < 0) {
                graph.Dependencies.push(item.dep);
            }
            else {
                var duplicateDep = graph.Dependencies[duplicateDepIndex];
                _.assign(duplicateDep, item.dep);
                graph.Dependencies.splice(duplicateDepIndex, 1, duplicateDep);
            }
        },
        changeNodeProperty: function (state, item) {
            var points = _.find(state.Graphs, function (x) { return x.Name === item.graph; }).Points;
            var point = _.find(points, function (x) { return x.name === item.name; });
            Vue.set(point, item.propName, item.newValue);
        },
        removeConnection: function (state, options) {
            var graph = _.find(state.Graphs, function (x) { return x.Name === options.graph; });
            _.remove(graph.Dependencies, function (x) { return x.Name === options.connectorName; });
        },
        removeNode: function (state, options) {
            var graph = _.find(state.Graphs, function (x) { return x.Name === options.graph; });
            _.remove(graph.Points, function (x) { return x.name === options.nodeName; });
        }
    }
};
var _a = getStoreAccessors("graph"), read = _a.read, commit = _a.commit;
export var readGraph = read(graphModule.getters.getGraph);
export var readGraphCount = read(graphModule.getters.graphCount);
export var getSyncfusionGraphByName = read(graphModule.getters.getSyncfusionGraphByName);
export var getSyncfusiongGraphByGraph = read(graphModule.getters.getSyncfusiongGraphByGraph);
export var getCharacteristicsList = read(graphModule.getters.getCharacteristicsList);
export var getRoles = read(graphModule.getters.getRoles);
export var addGraph = commit(graphModule.mutations.addGraph);
export var addPoint = commit(graphModule.mutations.addPoint);
export var addDependency = commit(graphModule.mutations.addDependency);
export var changeNodeProperty = commit(graphModule.mutations.changeNodeProperty);
export var removeConnection = commit(graphModule.mutations.removeConnection);
export var removeNode = commit(graphModule.mutations.removeNode);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiR3JhcGhTdG9yZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIkdyYXBoU3RvcmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxHQUFHLE1BQU0sS0FBSyxDQUFDO0FBRXRCLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBR3BELE9BQU8sQ0FBQyxNQUFNLFFBQVEsQ0FBQztBQVF2QixPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFJL0MsTUFBTSxDQUFDLElBQU0sV0FBVyxHQUFHO0lBQzFCLFVBQVUsRUFBRSxJQUFJO0lBRWhCLEtBQUssRUFBRTtRQUNOLE1BQU0sRUFBRSxFQUNQO1FBQ0QsZUFBZSxFQUFFO1lBQ2hCO2dCQUNDLElBQUksRUFBRSxRQUFRO2dCQUNkLE1BQU0sRUFBRSxDQUFDO3dCQUNSLEVBQUUsRUFBRSxNQUFNLEVBQUU7d0JBQ1osSUFBSSxFQUFFLGlCQUFpQjtxQkFDdkIsRUFBRTt3QkFDRixFQUFFLEVBQUUsTUFBTSxFQUFFO3dCQUNaLElBQUksRUFBRSxpQkFBaUI7cUJBQ3ZCLENBQUM7YUFDRjtZQUNEO2dCQUNDLElBQUksRUFBRSxRQUFRO2dCQUNkLE1BQU0sRUFBRSxDQUFDO3dCQUNSLEVBQUUsRUFBRSxNQUFNLEVBQUU7d0JBQ1osSUFBSSxFQUFFLGlCQUFpQjtxQkFDdkIsRUFBRTt3QkFDRixFQUFFLEVBQUUsTUFBTSxFQUFFO3dCQUNaLElBQUksRUFBRSxpQkFBaUI7cUJBQ3ZCLEVBQUU7d0JBQ0YsRUFBRSxFQUFFLE1BQU0sRUFBRTt3QkFDWixJQUFJLEVBQUUsaUJBQWlCO3FCQUN2QjtpQkFDQTthQUNEO1lBQ0Q7Z0JBQ0MsSUFBSSxFQUFFLFFBQVE7Z0JBQ2QsTUFBTSxFQUFFLENBQUM7d0JBQ1IsRUFBRSxFQUFFLE1BQU0sRUFBRTt3QkFDWixJQUFJLEVBQUUsaUJBQWlCO3FCQUN2QixFQUFFO3dCQUNGLEVBQUUsRUFBRSxNQUFNLEVBQUU7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QztBQUNuRSxNQUFNLENBQUMsSUFBTSx3QkFBd0IsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO0FBQzNGLE1BQU0sQ0FBQyxJQUFNLDBCQUEwQixHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLDBCQUEwQixDQUFDLENBQUM7QUFDL0YsTUFBTSxDQUFDLElBQU0sc0JBQXNCLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsc0JBQXNCLENBQUMsQ0FBQztBQUN2RixNQUFNLENBQUMsSUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUM7QUFFM0QsTUFBTSxDQUFDLElBQU0sUUFBUSxHQUFHLE1BQU0sQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQy9ELE1BQU0sQ0FBQyxJQUFNLFFBQVEsR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUMvRCxNQUFNLENBQUMsSUFBTSxhQUFhLEdBQUcsTUFBTSxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDLENBQUM7QUFDekUsTUFBTSxDQUFDLElBQU0sa0JBQWtCLEdBQUcsTUFBTSxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsa0JBQWtCLENBQUMsQ0FBQztBQUNuRixNQUFNLENBQUMsSUFBTSxnQkFBZ0IsR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0FBQy9FLE1BQU0sQ0FBQyxJQUFNLFVBQVUsR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBWdWUgZnJvbSBcInZ1ZVwiO1xyXG5pbXBvcnQgeyBBY3Rpb25Db250ZXh0LCBTdG9yZSwgR2V0dGVyVHJlZSB9IGZyb20gXCJ2dWV4XCI7XHJcbmltcG9ydCB7IGdldFN0b3JlQWNjZXNzb3JzIH0gZnJvbSBcInZ1ZXgtdHlwZXNjcmlwdFwiO1xyXG5pbXBvcnQgeyBHcmFwaCB9IGZyb20gXCIuLi9Nb2RlbC9HcmFwaFwiO1xyXG5pbXBvcnQgeyBSb290U3RhdGUgfSBmcm9tIFwiLi4vTW9kZWwvUm9vdFN0YXRlXCI7XHJcbmltcG9ydCBfIGZyb20gXCJsb2Rhc2hcIjtcclxuaW1wb3J0IHsgU2ZHcmFwaCB9IGZyb20gXCIuLi9Nb2RlbC9TeW5jZnVzaW9uR3JhcGgvR3JhcGhcIjtcclxuaW1wb3J0IHsgQmFzZVBvaW50IH0gZnJvbSBcIi4uL01vZGVsL0Jhc2VQb2ludFwiO1xyXG5pbXBvcnQgeyBOb2RlIH0gZnJvbSBcIi4uL01vZGVsL1N5bmNmdXNpb25HcmFwaC9Ob2RlXCI7XHJcbmltcG9ydCB7IENvbm5lY3RvciB9IGZyb20gXCIuLi9Nb2RlbC9TeW5jZnVzaW9uR3JhcGgvQ29ubmVjdG9yXCI7XHJcbmltcG9ydCB7IGNvbm5lY3QgfSBmcm9tIFwiaHR0cDJcIjtcclxuaW1wb3J0IHsgRGVwZW5kZW5jeSB9IGZyb20gXCIuLi9Nb2RlbC9EZXBlbmRlbmN5XCI7XHJcbmltcG9ydCB7IFBvaW50VHlwZSB9IGZyb20gXCIuLi9Nb2RlbC9Qb2ludFR5cGVcIjtcclxuaW1wb3J0IHsgdW5pcUlkIH0gZnJvbSBcIi4uL21peGlucy9JZEdlbmVyYXRvclwiO1xyXG5cclxudHlwZSBHcmFwaENvbnRleHQgPSBBY3Rpb25Db250ZXh0PFJvb3RTdGF0ZSwgUm9vdFN0YXRlPjtcclxuXHJcbmV4cG9ydCBjb25zdCBncmFwaE1vZHVsZSA9IHtcclxuXHRuYW1lc3BhY2VkOiB0cnVlLFxyXG5cclxuXHRzdGF0ZToge1xyXG5cdFx0R3JhcGhzOiBbXHJcblx0XHRdLFxyXG5cdFx0Q2hhcmFjdGVyaXN0aWNzOiBbXHJcblx0XHRcdHtcclxuXHRcdFx0XHROYW1lOiBcIkNoYXIgMVwiLFxyXG5cdFx0XHRcdFZhbHVlczogW3tcclxuXHRcdFx0XHRcdElkOiB1bmlxSWQoKSxcclxuXHRcdFx0XHRcdE5hbWU6IFwiQ2hhciAxLiBWYWx1ZSAxXCJcclxuXHRcdFx0XHR9LCB7XHJcblx0XHRcdFx0XHRJZDogdW5pcUlkKCksXHJcblx0XHRcdFx0XHROYW1lOiBcIkNoYXIgMS4gVmFsdWUgMlwiXHJcblx0XHRcdFx0fV1cclxuXHRcdFx0fSxcclxuXHRcdFx0e1xyXG5cdFx0XHRcdE5hbWU6IFwiQ2hhciAyXCIsXHJcblx0XHRcdFx0VmFsdWVzOiBbe1xyXG5cdFx0XHRcdFx0SWQ6IHVuaXFJZCgpLFxyXG5cdFx0XHRcdFx0TmFtZTogXCJDaGFyIDIuIFZhbHVlIDFcIlxyXG5cdFx0XHRcdH0sIHtcclxuXHRcdFx0XHRcdElkOiB1bmlxSWQoKSxcclxuXHRcdFx0XHRcdE5hbWU6IFwiQ2hhciAyLiBWYWx1ZSAyXCJcclxuXHRcdFx0XHR9LCB7XHJcblx0XHRcdFx0XHRJZDogdW5pcUlkKCksXHJcblx0XHRcdFx0XHROYW1lOiBcIkNoYXIgMi4gVmFsdWUgM1wiXHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdF1cclxuXHRcdFx0fSxcclxuXHRcdFx0e1xyXG5cdFx0XHRcdE5hbWU6IFwiQ2hhciAzXCIsXHJcblx0XHRcdFx0VmFsdWVzOiBbe1xyXG5cdFx0XHRcdFx0SWQ6IHVuaXFJZCgpLFxyXG5cdFx0XHRcdFx0TmFtZTogXCJDaGFyIDMuIFZhbHVlIDFcIlxyXG5cdFx0XHRcdH0sIHtcclxuXHRcdFx0XHRcdElkOiB1bmlxSWQoKSxcclxuXHRcdFx0XHRcdE5hbWU6IFwiQ2hhciAzLiBWYWx1ZSAyXCJcclxuXHRcdFx0XHR9LCB7XHJcblx0XHRcdFx0XHRJZDogdW5pcUlkKCksXHJcblx0XHRcdFx0XHROYW1lOiBcIkNoYXIgMy4gVmFsdWUgM1wiXHJcblx0XHRcdFx0fSwge1xyXG5cdFx0XHRcdFx0SWQ6IHVuaXFJZCgpLFxyXG5cdFx0XHRcdFx0TmFtZTogXCJDaGFyIDMuIFZhbHVlIDRcIlxyXG5cdFx0XHRcdH0sIHtcclxuXHRcdFx0XHRcdElkOiB1bmlxSWQoKSxcclxuXHRcdFx0XHRcdE5hbWU6IFwiQ2hhciAzLiBWYWx1ZSA1XCJcclxuXHRcdFx0XHR9LCB7XHJcblx0XHRcdFx0XHRJZDogdW5pcUlkKCksXHJcblx0XHRcdFx0XHROYW1lOiBcIkNoYXIgMy4gVmFsdWUgNlwiXHJcblx0XHRcdFx0fSwge1xyXG5cdFx0XHRcdFx0SWQ6IHVuaXFJZCgpLFxyXG5cdFx0XHRcdFx0TmFtZTogXCJDaGFyIDMuIFZhbHVlIDdcIlxyXG5cdFx0XHRcdH0sIHtcclxuXHRcdFx0XHRcdElkOiB1bmlxSWQoKSxcclxuXHRcdFx0XHRcdE5hbWU6IFwiQ2hhciAzLiBWYWx1ZSA4XCJcclxuXHRcdFx0XHR9LCB7XHJcblx0XHRcdFx0XHRJZDogdW5pcUlkKCksXHJcblx0XHRcdFx0XHROYW1lOiBcIkNoYXIgMy4gVmFsdWUgOVwiXHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdF1cclxuXHRcdFx0fVxyXG5cdFx0XSxcclxuXHRcdFJvbGVzOiBbXHJcblx0XHRcdHtcclxuXHRcdFx0XHRJZDogdW5pcUlkKCksXHJcblx0XHRcdFx0TmFtZTogXCJSb2xlIDFcIlxyXG5cdFx0XHR9LFxyXG5cdFx0XHR7XHJcblx0XHRcdFx0SWQ6IHVuaXFJZCgpLFxyXG5cdFx0XHRcdE5hbWU6IFwiUm9sZSAyXCJcclxuXHRcdFx0fSxcclxuXHRcdFx0e1xyXG5cdFx0XHRcdElkOiB1bmlxSWQoKSxcclxuXHRcdFx0XHROYW1lOiBcIlJvbGUgM1wiXHJcblx0XHRcdH1cclxuXHRcdF1cclxuXHR9LFxyXG5cdGdldHRlcnM6IHtcclxuXHRcdGdldEdyYXBoKHN0YXRlOiBSb290U3RhdGUpIHtcclxuXHRcdFx0cmV0dXJuIHN0YXRlLkdyYXBocztcclxuXHRcdH0sXHJcblx0XHRncmFwaENvdW50KHN0YXRlOiBSb290U3RhdGUpIHtcclxuXHRcdFx0cmV0dXJuIHN0YXRlLkdyYXBocy5sZW5ndGg7XHJcblx0XHR9LFxyXG5cdFx0Z2V0U3luY2Z1c2lvbkdyYXBoQnlOYW1lKHN0YXRlOiBSb290U3RhdGUpIHtcclxuXHRcdFx0cmV0dXJuIChuYW1lOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHR2YXIgZ3JhcGggPSBfLmZpcnN0KHN0YXRlLkdyYXBocy5maWx0ZXIoeCA9PiB4Lk5hbWUgPT09IG5hbWUpKTtcclxuXHRcdFx0XHRyZXR1cm4gZ3JhcGhNb2R1bGUuZ2V0dGVycy5nZXRTeW5jZnVzaW9uZ0dyYXBoQnlHcmFwaChzdGF0ZSkoZ3JhcGgpO1xyXG5cdFx0XHR9O1xyXG5cdFx0fSxcclxuXHRcdGdldFN5bmNmdXNpb25nR3JhcGhCeUdyYXBoKHN0YXRlOiBSb290U3RhdGUpIHtcclxuXHRcdFx0cmV0dXJuIChncmFwaDogR3JhcGgpID0+IHtcclxuXHRcdFx0XHRyZXR1cm4ge1xyXG5cdFx0XHRcdFx0TmFtZTogZ3JhcGguTmFtZSxcclxuXHRcdFx0XHRcdE5vZGVzOiBncmFwaC5Qb2ludHMsXHJcblx0XHRcdFx0XHRDb25uZWN0b3JzOiBfLm1hcChncmFwaC5EZXBlbmRlbmNpZXMsIGZ1bmN0aW9uIChjb24pIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIF8ubWVyZ2Uoe1xyXG5cdFx0XHRcdFx0XHRcdG5hbWU6IGNvbi5OYW1lLFxyXG5cdFx0XHRcdFx0XHRcdHNvdXJjZU5vZGU6IGNvbi5TdGFydCA/IGNvbi5TdGFydC5uYW1lIDogbnVsbCxcclxuXHRcdFx0XHRcdFx0XHR0YXJnZXROb2RlOiBjb24uRW5kID8gY29uLkVuZC5uYW1lOiBudWxsXHJcblx0XHRcdFx0XHRcdH0sIGNvbik7XHJcblx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdH07XHJcblx0XHRcdH07XHJcblx0XHR9LFxyXG5cdFx0Z2V0Q2hhcmFjdGVyaXN0aWNzTGlzdChzdGF0ZTogUm9vdFN0YXRlKSB7XHJcblx0XHRcdHJldHVybiBzdGF0ZS5DaGFyYWN0ZXJpc3RpY3M7XHJcblx0XHR9LFxyXG5cdFx0Z2V0Um9sZXMoc3RhdGU6IFJvb3RTdGF0ZSkge1xyXG5cdFx0XHRyZXR1cm4gc3RhdGUuUm9sZXM7XHJcblx0XHR9XHJcblx0fSxcclxuXHRtdXRhdGlvbnM6IHtcclxuXHRcdGFkZEdyYXBoKHN0YXRlOiBSb290U3RhdGUsIGl0ZW06IEdyYXBoKSB7XHJcblx0XHRcdHN0YXRlLkdyYXBocy5wdXNoKGl0ZW0pO1xyXG5cdFx0fSxcclxuXHRcdGFkZFBvaW50KHN0YXRlOiBSb290U3RhdGUsIGl0ZW06IHsgZ3JhcGg6IHN0cmluZywgcG9pbnQ6IEJhc2VQb2ludCB9KSB7XHJcblx0XHRcdHZhciBncmFwaCA9IF8uZmluZChzdGF0ZS5HcmFwaHMsIHggPT4geC5OYW1lID09PSBpdGVtLmdyYXBoKTtcclxuXHRcdFx0dmFyIGR1cGxpY2F0ZVBvaW50SW5kZXggPSBfLmZpbmRJbmRleChncmFwaC5Qb2ludHMsIHggPT4geC5uYW1lID09PSBpdGVtLnBvaW50Lm5hbWUpO1xyXG5cclxuXHRcdFx0aWYgKGR1cGxpY2F0ZVBvaW50SW5kZXggPCAwKSB7XHJcblx0XHRcdFx0Z3JhcGguUG9pbnRzLnB1c2goaXRlbS5wb2ludCk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dmFyIGR1cGxpY2F0ZVBvaW50ID0gZ3JhcGguUG9pbnRzW2R1cGxpY2F0ZVBvaW50SW5kZXhdO1xyXG5cdFx0XHRcdF8uYXNzaWduKGR1cGxpY2F0ZVBvaW50LCBpdGVtLnBvaW50KTtcclxuXHRcdFx0XHRncmFwaC5Qb2ludHMuc3BsaWNlKGR1cGxpY2F0ZVBvaW50SW5kZXgsIDEsIGR1cGxpY2F0ZVBvaW50KTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdGFkZERlcGVuZGVuY3koc3RhdGU6IFJvb3RTdGF0ZSwgaXRlbTogeyBncmFwaDogc3RyaW5nLCBkZXA6IERlcGVuZGVuY3kgfSkge1xyXG5cdFx0XHQvL1RPRE86INCf0YDQuNC80LXQvdC40YLRjCDQuNC30LzQtdC90LjQtSDQuiDQtNC40LDQs9GA0LDQvNC1XHJcblx0XHRcdHZhciBncmFwaCA9IF8uZmluZChzdGF0ZS5HcmFwaHMsIHggPT4geC5OYW1lID09PSBpdGVtLmdyYXBoKTtcclxuXHRcdFx0dmFyIGR1cGxpY2F0ZURlcEluZGV4ID0gXy5maW5kSW5kZXgoZ3JhcGguRGVwZW5kZW5jaWVzLCB4ID0+IHguTmFtZSA9PT0gaXRlbS5kZXAuTmFtZSk7XHJcblx0XHRcdGlmIChkdXBsaWNhdGVEZXBJbmRleCA8IDApIHtcclxuXHRcdFx0XHRncmFwaC5EZXBlbmRlbmNpZXMucHVzaChpdGVtLmRlcCk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dmFyIGR1cGxpY2F0ZURlcCA9IGdyYXBoLkRlcGVuZGVuY2llc1tkdXBsaWNhdGVEZXBJbmRleF07XHJcblx0XHRcdFx0Xy5hc3NpZ24oZHVwbGljYXRlRGVwLCBpdGVtLmRlcCk7XHJcblx0XHRcdFx0Z3JhcGguRGVwZW5kZW5jaWVzLnNwbGljZShkdXBsaWNhdGVEZXBJbmRleCwgMSwgZHVwbGljYXRlRGVwKTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdGNoYW5nZU5vZGVQcm9wZXJ0eShzdGF0ZTogUm9vdFN0YXRlLCBpdGVtOiB7IGdyYXBoOiBzdHJpbmcsIG5hbWU6IHN0cmluZywgcHJvcE5hbWU6IHN0cmluZywgbmV3VmFsdWU6IGFueSB9KSB7XHJcblx0XHRcdHZhciBwb2ludHMgPSBfLmZpbmQoc3RhdGUuR3JhcGhzLCB4ID0+IHguTmFtZSA9PT0gaXRlbS5ncmFwaCkuUG9pbnRzO1xyXG5cdFx0XHR2YXIgcG9pbnQgPSBfLmZpbmQocG9pbnRzLCB4ID0+IHgubmFtZSA9PT0gaXRlbS5uYW1lKTtcclxuXHRcdFx0VnVlLnNldChwb2ludCwgaXRlbS5wcm9wTmFtZSwgaXRlbS5uZXdWYWx1ZSk7XHJcblx0XHR9LFxyXG5cdFx0cmVtb3ZlQ29ubmVjdGlvbihzdGF0ZTogUm9vdFN0YXRlLCBvcHRpb25zOiB7IGdyYXBoOiBzdHJpbmcsIGNvbm5lY3Rvck5hbWU6IHN0cmluZyB9KSB7XHJcblx0XHRcdHZhciBncmFwaCA9IF8uZmluZChzdGF0ZS5HcmFwaHMsIHggPT4geC5OYW1lID09PSBvcHRpb25zLmdyYXBoKTtcclxuXHRcdFx0Xy5yZW1vdmUoZ3JhcGguRGVwZW5kZW5jaWVzLCB4ID0+IHguTmFtZSA9PT0gb3B0aW9ucy5jb25uZWN0b3JOYW1lKTtcclxuXHRcdH0sXHJcblx0XHRyZW1vdmVOb2RlKHN0YXRlOiBSb290U3RhdGUsIG9wdGlvbnM6IHsgZ3JhcGg6IHN0cmluZywgbm9kZU5hbWU6IHN0cmluZyB9KSB7XHJcblx0XHRcdHZhciBncmFwaCA9IF8uZmluZChzdGF0ZS5HcmFwaHMsIHggPT4geC5OYW1lID09PSBvcHRpb25zLmdyYXBoKTtcclxuXHRcdFx0Xy5yZW1vdmUoZ3JhcGguUG9pbnRzLCB4ID0+IHgubmFtZSA9PT0gb3B0aW9ucy5ub2RlTmFtZSk7XHJcblx0XHR9XHJcblx0fVxyXG59O1xyXG5cclxuY29uc3QgeyByZWFkLCBjb21taXQgfSA9XHJcblx0Z2V0U3RvcmVBY2Nlc3NvcnM8Um9vdFN0YXRlLCBSb290U3RhdGU+KFwiZ3JhcGhcIik7XHJcblxyXG5leHBvcnQgY29uc3QgcmVhZEdyYXBoID0gcmVhZChncmFwaE1vZHVsZS5nZXR0ZXJzLmdldEdyYXBoKTtcclxuZXhwb3J0IGNvbnN0IHJlYWRHcmFwaENvdW50ID0gcmVhZChncmFwaE1vZHVsZS5nZXR0ZXJzLmdyYXBoQ291bnQpO1xyXG5leHBvcnQgY29uc3QgZ2V0U3luY2Z1c2lvbkdyYXBoQnlOYW1lID0gcmVhZChncmFwaE1vZHVsZS5nZXR0ZXJzLmdldFN5bmNmdXNpb25HcmFwaEJ5TmFtZSk7XHJcbmV4cG9ydCBjb25zdCBnZXRTeW5jZnVzaW9uZ0dyYXBoQnlHcmFwaCA9IHJlYWQoZ3JhcGhNb2R1bGUuZ2V0dGVycy5nZXRTeW5jZnVzaW9uZ0dyYXBoQnlHcmFwaCk7XHJcbmV4cG9ydCBjb25zdCBnZXRDaGFyYWN0ZXJpc3RpY3NMaXN0ID0gcmVhZChncmFwaE1vZHVsZS5nZXR0ZXJzLmdldENoYXJhY3RlcmlzdGljc0xpc3QpO1xyXG5leHBvcnQgY29uc3QgZ2V0Um9sZXMgPSByZWFkKGdyYXBoTW9kdWxlLmdldHRlcnMuZ2V0Um9sZXMpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGFkZEdyYXBoID0gY29tbWl0KGdyYXBoTW9kdWxlLm11dGF0aW9ucy5hZGRHcmFwaCk7XHJcbmV4cG9ydCBjb25zdCBhZGRQb2ludCA9IGNvbW1pdChncmFwaE1vZHVsZS5tdXRhdGlvbnMuYWRkUG9pbnQpO1xyXG5leHBvcnQgY29uc3QgYWRkRGVwZW5kZW5jeSA9IGNvbW1pdChncmFwaE1vZHVsZS5tdXRhdGlvbnMuYWRkRGVwZW5kZW5jeSk7XHJcbmV4cG9ydCBjb25zdCBjaGFuZ2VOb2RlUHJvcGVydHkgPSBjb21taXQoZ3JhcGhNb2R1bGUubXV0YXRpb25zLmNoYW5nZU5vZGVQcm9wZXJ0eSk7XHJcbmV4cG9ydCBjb25zdCByZW1vdmVDb25uZWN0aW9uID0gY29tbWl0KGdyYXBoTW9kdWxlLm11dGF0aW9ucy5yZW1vdmVDb25uZWN0aW9uKTtcclxuZXhwb3J0IGNvbnN0IHJlbW92ZU5vZGUgPSBjb21taXQoZ3JhcGhNb2R1bGUubXV0YXRpb25zLnJlbW92ZU5vZGUpOyJdfQ==